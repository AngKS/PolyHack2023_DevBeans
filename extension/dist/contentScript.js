const overlayButton=document.createElement("button");overlayButton.innerText="Overlay",overlayButton.style.position="absolute",overlayButton.style.zIndex="2147483647",overlayButton.style.background="#F1FCFE",overlayButton.style.color="#3b82f6",overlayButton.style.border="none",overlayButton.style.padding="3px 6px",overlayButton.style.borderRadius="5px",overlayButton.style.cursor="pointer",overlayButton.style.display="none",overlayButton.setAttribute("data-state","idle");let currentStatus="idle";const loadingContainer=document.createElement("div");loadingContainer.style.position="relative",loadingContainer.style.display="flex",loadingContainer.style.justifyContent="center",loadingContainer.style.alignItems="center",loadingContainer.style.width="25px",loadingContainer.style.height="25px";var logoImg=document.createElement("img");logoImg.id="logoImg",logoImg.src="https://mindful-beans.netlify.app/static/media/logo.c1326f89940153adfbe4.png",logoImg.alt="Logo",logoImg.style.position="absolute",logoImg.style.zIndex="2",logoImg.style.width="25px",logoImg.style.height="25px";var spinner=document.createElement("div");function showLoading(){overlayButton.innerHTML="",overlayButton.appendChild(loadingContainer),overlayButton.style.background="RGBA(241, 252, 254, 0)"}function hideLoading(){overlayButton.removeChild(loadingContainer),overlayButton.innerHTML="finished loading",overlayButton.style.background="#F1FCFE"}function positionOverlayButton(t){const e=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight;e.top<n/2?(overlayButton.style.top=`${e.bottom+window.scrollY}px`,overlayButton.style.left=`${e.left+window.scrollX}px`):(overlayButton.style.top=e.top+window.scrollY-overlayButton.offsetHeight+"px",overlayButton.style.left=`${e.left+window.scrollX}px`)}function updateButtonState(t,e=[]){if(overlayButton.setAttribute("data-state",t),"suggestions"===t){let t=document.createElement("div");t.className="suggestion-dropdown",e.forEach((e=>{let n=document.createElement("p");n.innerText=e,t.appendChild(n)})),overlayButton.appendChild(t)}"success"===t&&(currentStatus!=t&&(hideLoading(),currentStatus=t),overlayButton.innerText="Success!"),"processing"===t&&currentStatus!=t&&(showLoading(),currentStatus=t)}function captureUserInputs_(){const t=document.querySelectorAll('input, textarea, [contenteditable="true"]');for(let e=0;e<t.length;e++)"true"!==t[e].dataset.listening&&(t[e].addEventListener("input",(function(t){let e="";e="true"===this.getAttribute("contenteditable")?this.innerText:this.value,chrome.runtime.sendMessage({action:"logInput",inputValue:e})})),t[e].addEventListener("focus",(function(){overlayButton.style.display="block",positionOverlayButton(this)})),t[e].dataset.listening="true")}function captureUserInputs(){document.addEventListener("keydown",(function(t){const e=document.activeElement,n=e.innerText||e.value;chrome.runtime.sendMessage({action:"logInput",inputValue:n}),overlayButton.style.display="block",positionOverlayButton(e)}))}function retrieveLocalStorageData(){"mindful-beans.netlify.app"==window.location.hostname&&(localStorage.length>0?chrome.runtime.sendMessage({localStorageData:localStorage,website:window.location.hostname}):setTimeout(retrieveLocalStorageData,500))}spinner.classList.add("grow-pulse"),spinner.classList.add("spinner"),spinner.style.position="absolute",spinner.style.zIndex="1",spinner.style.width="25px",spinner.style.height="25px",loadingContainer.appendChild(spinner),loadingContainer.appendChild(logoImg),overlayButton.addEventListener("click",(()=>{chrome.runtime.sendMessage({action:"overlayClicked"})})),document.body.appendChild(overlayButton),chrome.runtime.onMessage.addListener((function(t,e,n){"updateButtonState"===t.action&&updateButtonState(t.state,t.suggestions)})),captureUserInputs(),retrieveLocalStorageData(),window.addEventListener("resize",(()=>{const t=document.activeElement;!t||"input"!==t.tagName.toLowerCase()&&"textarea"!==t.tagName.toLowerCase()||positionOverlayButton(t)}));const observer=new MutationObserver((function(t){for(const e of t)if("childList"===e.type){const t=document.documentElement.innerText;console.log(t);const e=document.head.getElementsByTagName("meta");for(let t=0;t<e.length;t++){const n=e[t],o=n.getAttribute("name"),a=(n.getAttribute("property"),n.getAttribute("content"));if("description"===o){const t=a;console.log("Description:",t)}if("keywords"===o){const t=a;console.log("Keywords:",t)}}chrome.runtime.sendMessage({pageContent:t,currentWebsite:window.location.hostname})}}));observer.observe(document,{childList:!0,subtree:!0});